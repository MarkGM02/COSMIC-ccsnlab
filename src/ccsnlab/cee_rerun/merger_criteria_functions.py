import numpy as np
from scipy.interpolate import interp1d

"""Create the interpolations from the Klencki Paper. First is the criteria from figure 2, alpha=1.0"""

def create_interp(x,y):
    return interp1d(x, y, bounds_error=False, kind='linear', fill_value='extrapolate')

# z dim = 1
x = [9.262164704944901, 10.381509950640206, 11.393522808600343, 12.357340376163389, 13.5073531643334, 14.749368579927536, 15.483183589856583, 16.35719651760683, 17.047204190508843, 17.829214490834968, 18.6112167693085, 19.39103710387591, 20.31104733441192, 21.139054937523806, 22.10507049269818, 23.071078026019954, 24.080900918221356, 25.092913776181497, 26.104918612289026, 27.024928842825027, 27.850754502030806, 29.092761895772338, 30.196777381156593, 31.390597506353636, 32.40261036431377, 33.32262059484979, 34.518638707658155, 35.48245627522121, 36.402466505757225, 37.32247673629324, 38.380486897039134, 39.20630453439229, 40.21831739235242, 41.00032769267855, 42.1043351562102, 43.16016337304997, 44.26417083658163, 45.414183624751644, 46.6080037499487, 47.712019235332946, 48.67802676865472, 49.64404232382908, 50.334049996731096, 50.56186258860636, 51.02186770387438, 51.389870191718266, 51.98787523719615, 52.44788035246416, 53.36789058300017, 54.42590074374606, 55.48391892634456, 56.309736563697726, 57.18374146959537, 58.011757094559854, 59.115764558091506, 60.079582125654575, 61.04559768082894]
y = [276.7854457435212, 306.5822879860718, 332.7447754928594, 367.6287258392408, 404.692756743721, 463.4549385813573, 511.4201326811318, 563.7458680995044, 633.409213132435, 709.7173554994949, 766.4036322364652, 809.904299661409, 860.0497644204829, 912.3753097376556, 982.0390349729855, 1034.3645802901583, 1077.969233071335, 1119.3936151932135, 1141.1959415838023, 1175.9759065739504, 1193.4176916459417, 1230.4817225504219, 1245.7432369631144, 1271.9061046723002, 1271.9061046723002, 1284.9875385268933, 1308.969945475581, 1337.313083844066, 1369.9127781749157, 1417.8777821734907, 1457.12208373727, 1500.726736518447, 1542.0473233852924, 1590.0123273838674, 1637.9775214836418, 1670.6810110695246, 1688.122796141516, 1707.7450419740053, 1731.6236536676595, 1749.0656288408502, 1764.3271432535423, 1777.4085771081357, 1755.6062507175468, 1716.4659345100008, 1675.0415523881225, 1640.157792142941, 1600.9134905791614, 1561.669379116582, 1568.2100009932785, 1583.4717055071706, 1590.0123273838674, 1605.274031897759, 1627.0763582883476, 1635.797250824343, 1644.5181433603384, 1644.5181433603384, 1648.8786846789362]
z_dim_1_interp = create_interp(x, y)


# z dim = 0.4
x = [9.1162789960711, 10.232558784377824, 11.34883857268454, 12.320174893934505, 13.256898441137778, 14.228230801209662, 15.095728800319584, 15.822608938834058, 16.309358501074364, 16.793945260084016, 17.45375869255772, 18.07896331216281, 18.77122671545253, 19.60411194051578, 20.29854210821423, 20.992968314734608, 21.754461227295767, 22.656568039274283, 23.558678812430887, 24.56462790772752, 25.397513132790763, 26.29962390594737, 27.132501208654457, 28.173063077997774, 29.213632869697243, 30.42725860927395, 31.60627157480397, 32.577607896053934, 33.6873953134906, 34.79719065328343, 35.909140873950754, 36.94970274329406, 38.440238597600356, 39.446187692896984, 40.348298466053585, 41.3888603353969, 42.325583882600185, 43.435371300036856, 44.579771491520205, 45.551107812770155, 46.74526832327095, 47.71660464452091, 48.72255373981754, 50.28447794544784, 51.04812970006158, 52.01946602131152, 52.60789110246122, 53.19848690919771, 53.717686442254035, 54.48133819686779, 55.14115955169763, 55.904811306311366, 56.841534853514645, 57.56841103085104, 58.64358567424102, 59.55002205385896, 60.31151892759817, 60.86749403793184, 61.804217585135135, 62.60248211379554, 63.53920566099882, 64.3699280828314, 65.272038855988, 66.41643904747136, 67.56300204218535, 68.42833723806463, 69.46889910740794, 70.33639710651786, 71.8961585089175, 73.14655982577153, 74.39480626175109, 75.57381922728112, 77.02974230754072, 78.14169252820804, 79.28610064204756, 80.49972638162426]
y = [291.6666000192347, 304.92432671364156, 318.1816770460798, 354.46033625387975, 387.3472214035973, 430.20318236894695, 476.3477942130717, 529.0697078147462, 590.1163717926648, 649.4155871518897, 702.137500753564, 758.1482534149973, 809.2258415772847, 858.6591043001843, 913.128278339569, 957.5258179269674, 997.0929398325579, 1035.0157362987607, 1072.938532764964, 1122.3719836688476, 1161.9391055744381, 1196.4705043445276, 1234.3933008107308, 1269.0274463981586, 1293.7954511682776, 1321.7493599998331, 1348.1618783903239, 1374.4714617824918, 1389.3733257353022, 1412.3942582486948, 1432.1263517023287, 1451.9613801542853, 1461.8275209715944, 1468.4050109101283, 1483.3068748629387, 1496.4616665590227, 1504.683481936944, 1509.6164582551066, 1512.9051091338815, 1521.1269245118033, 1531.0958121464505, 1549.1835801606971, 1578.8847494299628, 1613.4161482000525, 1661.2050854835643, 1705.7051837073172, 1732.1177020978078, 1773.329149442786, 1831.2924679956232, 1856.0604727657421, 1882.3702443388945, 1877.4370798397479, 1865.9266135830514, 1849.4831710081926, 1851.12749644758, 1870.6540962665365, 1880.6229839011842, 1910.2214063531108, 1941.56671288078, 1956.3660181972357, 1974.5565330288207, 1976.2008584682083, 1979.4896975279673, 2009.08793179891, 2030.5672856902543, 2048.655053704501, 2066.84575671707, 2075.067572094991, 2089.5582605974623, 2104.3575659139183, 2122.4453339281645, 2134.0585470021992, 2153.7908286368174, 2155.435154076205, 2162.012455833755, 2173.62566890779]
z_dim_0_4_interp = create_interp(x, y)

# z dim = 0.2
x = [9.426549658664213, 10.213058808251308, 10.999565974173745, 11.786077107425491, 12.429581888454038, 13.0730906368119, 13.859597802734339, 14.360104166198305, 14.574605759874483, 14.860610529662265, 15.361116893126233, 15.933122465372492, 16.64813042251264, 17.50614076454668, 18.149645545575225, 18.936156678826972, 19.72266384474941, 20.29466941699567, 21.15267975902971, 21.867687716169858, 22.7256980582039, 23.44070601534404, 24.155713972484193, 25.01372431451823, 25.657229095546775, 26.65824182247471, 27.51625216450875, 28.374262506542788, 29.089270463682933, 29.80427842082308, 30.59078558674552, 31.44879592877956, 32.378305479595895, 33.37931820652382, 34.38032696612244, 35.30983651693877, 36.310849243866706, 36.95435799222456, 37.95536675182319, 38.81337709385723, 39.59988425977967, 40.5293977779253, 41.60190971363552, 42.745920858128045, 43.67543437627367, 45.10545029055397, 45.89195745647641, 46.964469392186636, 47.82247576689137, 49.10949326360708, 50.61100838666967, 49.96749963831181, 51.683520322379884, 52.47002748830232, 53.328041797665676, 54.257547381152705, 55.33005931686291, 56.40257125257314, 57.40358397950108, 58.1900911454235, 59.19110387235145, 60.263615808061665, 60.97862376520181, 61.90813728334745, 62.90914207561677, 63.481151615192324, 64.33915798989705, 65.1971722992604, 65.76917390417736, 66.6271882135407, 67.27069696189855, 68.057204127821, 68.62920573273794, 69.27271448109582, 70.48823276902922, 71.27473993495167, 72.34725187066189, 73.13375903658432, 74.13477176351225, 75.06427734699929, 76.20829642615041, 77.78131075799527, 78.78231951759392, 79.85483145330412, 80.99885053245526]
y = [300.50498231320586, 310.67936330901324, 327.63672769568444, 351.37707547322094, 371.7260256458146, 392.0747876374287, 436.16389740657996, 483.6445929616523, 534.5166861216674, 585.3887792816829, 643.0438558325625, 697.3073465975201, 744.7880421525931, 785.4855661358216, 822.7918806950869, 853.315023682509, 883.8383548509094, 914.3616860193105, 941.493431401789, 975.4081601751329, 1012.7142865534194, 1046.6290153267626, 1070.369363104299, 1107.675489482585, 1138.1988206509857, 1168.7221518193867, 1202.63688059273, 1233.160023580152, 1256.9003713576883, 1273.8577357443594, 1317.9468455135107, 1345.0785908959895, 1378.993319669333, 1406.1252532327912, 1436.648396220213, 1470.5631249935561, 1490.9119810756604, 1521.4352181535717, 1551.9585493219722, 1572.3073113135868, 1606.2220400869303, 1619.7880068686593, 1602.8306424819875, 1602.8306424819875, 1613.0050234777948, 1629.9623878644668, 1640.1367688602738, 1650.3112439465706, 1657.0941332469454, 1677.4429893290496, 1694.4003537157212, 1687.6174644153464, 1697.7918454111534, 1704.574828802018, 1714.7492097978254, 1724.9235907936325, 1741.8809551803045, 1752.0554302666012, 1765.6213029578405, 1769.0127946532727, 1775.795683953648, 1792.7530483403195, 1809.710412726991, 1816.4933961178556, 1840.233743895392, 1863.9739975824389, 1904.671709746647, 1925.0205658287507, 1962.3266922070368, 1986.0670399845733, 2019.9817687579168, 2060.6794809221246, 2104.7685906912757, 2138.683319464619, 2175.9895399333946, 2159.032175546723, 2111.55157408214, 2091.2027180000364, 2091.2027180000364, 2118.334463382515, 2121.725955077947, 2155.6406838512908, 2196.338396015499, 2240.4275057846494, 2260.7763618667536]
z_dim_0_2_interp = create_interp(x, y)

# z dim = 0.1
x = [9.06289592193823, 9.828926954569202, 10.592788456667106, 11.37401017652866, 12.090130086401754, 12.741148186286384, 13.32706447618255, 13.880429861084487, 14.336142531003727, 14.644291363182393, 14.969800413124705, 15.327860368061257, 15.67072963576722, 16.191544115674922, 16.87511312055378, 17.47622009768053, 18.07949660534035, 19.233968967369034, 19.251329185132683, 19.93489819001154, 20.79641240709214, 22.130999511855634, 22.148355756120132, 23.027230190964385, 23.725993856572977, 25.06058096133647, 24.63741919641145, 25.498929439992914, 26.195523575068442, 26.651236244987686, 27.22195787415412, 27.725416109797315, 28.116026969728097, 28.458892263934917, 28.799595974606962, 29.172842643274947, 29.61336859946274, 29.938877649405054, 30.362039414330074, 30.882853894237776, 31.56642289911664, 32.42793314269809, 33.241705767553874, 33.82762205745004, 34.665267465167815, 35.41176874950208, 36.39914355199433, 37.210746646317055, 38.10915480295716, 38.899054644950965, 39.64555592928522, 40.546133616458405, 41.33603345845219, 42.10206051758403, 42.87026505424721, 43.703571400898845, 44.34156437058681, 45.35064242540798, 46.270753834377004, 47.27983188919818, 48.180401629373065, 49.013707976024705, 49.957684220857416, 50.74758406285122, 51.64599221949133, 52.54656195966619, 53.48836867396585, 54.43234491879857, 55.50652478360821, 56.493907533098756, 57.548553676112526, 58.38186002276418, 59.764184746253335, 60.619186398235605, 62.001519068723056, 63.34044523455268, 64.50143016167968, 65.73184801286301, 67.6393342243243, 67.6610374766532, 68.75908217732655, 69.92223663498663, 71.15483196370128, 72.27457991670354, 73.34875978151317, 74.3144392786748, 75.45589048400596, 76.59734168933714, 77.75832661646416, 78.57209924131993, 79.62457585380065, 80.5902553509623]
y = [307.9405716525947, 308.6629118361783, 325.68475248029216, 345.079133057933, 372.1079542369645, 405.42929534160714, 446.3850770476407, 478.88131827731166, 517.5673197412057, 557.0784210800714, 592.5664049424819, 631.2524064063759, 666.8435277531581, 701.7126867093397, 735.7561791010748, 761.2373713250593, 786.8217010334146, 837.0619341942912, 836.339782907199, 868.8360241368699, 860.2735350726274, 827.7772938429564, 827.0551425558646, 804.5656929646206, 790.6387324376185, 764.332251442171, 769.7998603893014, 795.2810526132855, 834.8954803330147, 868.2171992306405, 904.5302829680236, 937.0265241976945, 974.1650856030328, 1014.398527125482, 1057.0048863744423, 1090.223089994714, 1129.734569126563, 1176.8797332738363, 1220.9302062004895, 1258.0687676058274, 1288.1922800054788, 1319.966369948058, 1351.6373224062647, 1374.8489232846011, 1407.345164514272, 1425.0891564454773, 1458.4106864466119, 1484.5108924733167, 1508.444644638745, 1527.2202003101572, 1547.130646102639, 1571.0643982680674, 1595.101287917867, 1611.710389728003, 1636.7790320145011, 1658.649467803025, 1680.623229972411, 1698.2638955227537, 1720.2376576921404, 1741.076529740457, 1744.1714098575687, 1746.3376748223534, 1745.2029735977753, 1773.3663071048934, 1819.2738214397084, 1851.6669251850076, 1878.798694951919, 1901.803831965021, 1922.6427040133378, 1946.5764561787662, 1970.6133458285663, 1984.1277564180818, 2010.2279624447867, 2033.129961973517, 2062.325048117333, 2103.074365958132, 2121.849921629544, 2121.849921629544, 2142.6887936778608, 2142.6887936778608, 2161.464349349273, 2182.30322139759, 2184.6759502276095, 2182.6126338507047, 2177.351488768808, 2164.868641919499, 2155.480864083793, 2159.607496837603, 2159.607496837603, 2185.707513967816, 2210.6730187699427, 2229.4485744413546]

z_dim_0_1_interp = create_interp(x, y)

# z dim = 0.04
x = [9.190258566103026, 10.038050821382706, 10.983256858233448, 11.78082191780822, 12.677322457370149, 13.325722054259419, 14.121765415418093, 14.7701677993008, 15.167428630672088, 15.815828227561358, 16.462708913027967, 17.01065411850742, 17.709283698095035, 18.207001707869576, 18.853882393336185, 19.60122025720605, 20.497718009774545, 21.444442958047944, 22.441400676013128, 23.33789842858162, 24.085236292451484, 25.08067231200057, 25.87823179758847, 26.625569661458332, 27.222220364226597, 27.82039833939783, 28.61795782498573, 29.414001186144404, 30.16133905001427, 30.85997141659532, 31.456622119363583, 31.90562905786244, 32.55251253032249, 33.49923747859589, 34.345508035459474, 35.14307309503425, 35.791478265910385, 36.53728885737728, 37.23592122395833, 37.93302631813641, 38.38051713220605, 38.87975684039669, 39.277014884774545, 39.77625459296518, 40.07457994434931, 40.42313806542523, 40.722985115225455, 41.02131046660959, 41.31963581799372, 41.61948286779395, 41.76864275649258, 42.06697368186359, 42.31658796197203, 42.564686117651256, 43.013698630136986, 43.462711142622716, 43.85996918700057, 44.25875450378139, 44.756466939569066, 45.20547945205479, 45.404872110445204, 45.604259194848744, 45.90259012021975, 46.152204400328195, 46.40030255600742, 46.64992241010274, 46.84931506849315, 47.19786761558219, 47.34703307826769, 47.596652932363014, 48.4429234892266, 49.339421241795094, 50.13698630136986, 51.182649516623854, 51.87975461080194, 52.57838697738299, 53.474884729951484, 54.470320749500566, 55.566211160459474, 56.31354902432933, 56.9117214255137, 57.95738464076769, 58.853882393336185, 59.75038014590468, 60.79756505957477, 61.64383561643835, 62.49010617330194, 63.33789842858162, 64.3333344481307, 65.33028659210902, 66.37594980736301, 67.32268032962328, 68.12024538919806, 69.31506849315068, 70.16134462400115, 70.90867133989727, 72.10502729023972, 73.29984482020548, 74.4961896225742, 75.69101830051369, 76.78690871147259, 77.73363923373287, 78.68036975599315, 79.37747485017124, 79.92542005565068, 80.57230352811072, 81.31963024400685]
y = [336.8606095266814, 348.7005611457447, 377.0730330212281, 405.3733278029036, 403.0631320311291, 388.8408075464834, 379.38322879300256, 410.1380735340685, 447.89594706922475, 483.3436248326065, 481.0334290608321, 455.0433300509311, 424.2884853098652, 400.68075916554665, 372.3082872900632, 351.08293401132715, 329.78540363878307, 308.560314745006, 306.17767749446455, 306.17767749446455, 310.8705105167804, 317.94545201971977, 322.7104621358437, 325.0928350014262, 325.0928350014262, 325.0928350014262, 320.3280892702612, 315.63525624794534, 315.63525624794534, 343.9355510296208, 374.6906601556457, 410.1380735340685, 443.2033784318678, 443.2033784318678, 443.2033784318678, 447.89594706922475, 473.8860460791257, 497.56594931725226, 530.6312542150516, 563.696294727892, 603.8365411286306, 639.2842188920125, 677.1142695209767, 712.5619472843586, 752.7021936850972, 795.2248129514184, 837.7474322177395, 885.0350616001847, 925.1753080009233, 963.0053586298876, 1007.9104829542707, 1048.0507293550095, 1085.8807799839738, 1123.63865351913, 1163.8510770136766, 1194.533876853414, 1227.599049558734, 1253.589148568635, 1289.0366941395373, 1324.484371902919, 1371.6275149052685, 1407.0750604761708, 1447.2874839707176, 1489.8102354295183, 1532.3328546958394, 1572.4732332890576, 1617.3783576134408, 1657.5186040141793, 1700.0412232805006, 1740.2536467750474, 1752.1658415841584, 1775.7735677284768, 1797.0709659085414, 1811.221113299379, 1832.5185114794438, 1851.433536793926, 1877.423635803827, 1898.648989082563, 1922.256583034402, 1938.7892354833016, 1943.5539812144666, 1957.7042607977837, 1986.0767326732673, 2002.609385122167, 2019.1419053785871, 2042.7496315229057, 2066.4294025685526, 2090.0371287128714, 2106.4252947816753, 2122.957947230575, 2141.872972545057, 2158.4054928014775, 2170.2454444205405, 2172.555640192315, 2177.3205181159597, 2182.013218945796, 2193.8531705648593, 2200.928244260278, 2208.0033179556967, 2203.3106171258605, 2189.0882926412146, 2170.2454444205405, 2153.640614877833, 2137.108094621413, 2122.957947230575, 2113.500368477094, 2108.8077998397375]
z_dim_0_04_interp = create_interp(x, y)

# z dim = 0.01
x = [9.197494963447996, 10.06626016255596, 11.2810586437433, 12.611813813672796, 14.174489101578882, 15.73531749459946, 17.35505104968001, 18.976624759153786, 20.59635157374205, 22.621020202715812, 23.894717105470843, 25.57150892772586, 27.36609759311625, 29.390759481597726, 31.4154213700792, 32.9191982364176, 35.002758546466765, 36.73844879028947, 38.242225656627866, 40.441742655419176, 42.4093462767262, 44.1450365205489, 45.30093658016855, 46.053741720288215, 46.97956855681679, 48.07841034926198, 48.83121548938165, 49.58402062950131, 50.277927348053296, 50.97184080709756, 52.07067585905047, 53.34437950229778, 54.211301176766376, 54.964106316886046, 55.716911457005715, 56.23780321964107, 56.75869498227644, 57.277746590518575, 57.56856513006285, 57.97349346346378, 58.37842853735699, 58.840421878424664, 59.01343683434128, 59.59322701854433, 59.99816209243754, 60.519047114580616, 60.98104045564829, 61.328917262367035, 61.73384559576796, 62.081722402486704, 62.25473735840332, 62.42775905481222, 62.891585809780835, 63.005702344129766, 63.35357915084851, 63.585492528332814, 63.75851422474172, 63.93152918065834, 64.27940598737709, 64.62727605360354, 64.80029100952015, 65.49420446856442, 66.13105291994194, 66.13105291994194, 66.42002456460071, 66.82495963849391, 67.28879313395481, 67.86674316376464, 68.44468645308218, 69.60242666709506, 70.70127520003254, 71.62709529606883, 72.3210020146208, 73.07380715474048, 73.59469891737584, 73.88367730252688, 74.3475040574955, 74.69353396932874, 75.38928758276623, 76.54518764238588, 77.3550577901723, 78.33977630777628, 79.26559640381257, 80.36444493675003, 81.29026503278632]
y = [222.97272184001866, 214.78840842175842, 203.81838670417446, 198.33337584538248, 192.8483649865905, 173.6940298507463, 173.6940298507463, 168.2090189919543, 154.53969471490205, 151.84071099580225, 149.05468385611007, 149.05468385611007, 154.53969471490205, 157.23867843400188, 162.72400813316233, 162.72400813316233, 176.3930135698461, 184.66405156833025, 195.54734870569033, 209.30339756296644, 222.97272184001866, 242.12673813549443, 269.4650678492304, 296.8904409835588, 324.2287706972948, 348.868116691931, 370.72143554687506, 398.14680868120337, 420.00012753614743, 422.7861546758396, 441.94017097131535, 466.57951696595154, 480.24884124300377, 491.1318195399954, 521.2561763934235, 581.5048901002799, 638.9675766674441, 685.4602415170243, 748.4079389429804, 846.9653229215253, 929.0670366429572, 1027.624420621502, 1148.0348046146223, 1284.900540024487, 1452.7612259138878, 1562.2014287692398, 1692.537313432836, 1781.6916166846433, 1882.9478249621036, 1962.35071438462, 2022.5994280914763, 2069.0920929410568, 2025.2985712307604, 1995.174054957148, 1956.865703525828, 1910.3731980964321, 1855.6094952483677, 1800.8457924003033, 1746.1691329728312, 1699.589584122843, 1664.0671004110309, 1647.6119084144707, 1647.6119084144707, 1702.3756112625351, 1768.0224518277753, 1819.9999681159634, 1863.7934898262595, 1897.4875834450795, 1944.0671322950677, 1982.375643146572, 1998.7437917225398, 2034.35315943476, 2053.507494570604, 2097.3010162809005, 2153.80590638118, 2200.2985712307604, 2249.5771037998484, 2320.708955223881, 2359.017466075385, 2383.656652649837, 2394.626833787605, 2408.295998644473, 2432.935344639109, 2452.0895203547693, 2457.5746906337454]
z_dim_0_01_interp = create_interp(x, y)

#these models return True if the star WOULD SURVIVE!!!!!! NOT MERGE
def z_dim_1_model(m_zams, R_ce, kstar):
    return z_dim_1_interp(m_zams) < R_ce

def z_dim_0_4_model(m_zams, R_ce, kstar):
    return z_dim_0_4_interp(m_zams) < R_ce

def z_dim_0_2_model(m_zams, R_ce, kstar):
    return z_dim_0_2_interp(m_zams) < R_ce

def z_dim_0_1_model(m_zams, R_ce, kstar):
    return z_dim_0_1_interp(m_zams) < R_ce

def z_dim_0_04_model(m_zams, R_ce, kstar):
    return z_dim_0_04_interp(m_zams) < R_ce

def z_dim_0_01_model(m_zams, R_ce, kstar):
    return z_dim_0_01_interp(m_zams) < R_ce


"""Now we create the model based on figure 5 -- which has alpha=0.7, and more realistic energy budget assumptions"""

# z dim = 1
x = [9.0015869140625, 9.81745837983631, 10.563494001116071, 11.31111072358631, 12.034917922247026, 12.668253580729168, 13.347621372767858, 14.049205961681547, 14.704764229910715, 15.249203636532737, 15.836507161458334, 16.266665504092263, 16.652378627232142, 16.990478515625, 17.37619163876488, 17.828572591145832, 18.280953543526785, 18.757144019717263, 19.095238095238095, 19.571428571428573, 19.88730003720238, 20.363490513392858, 20.67936779203869, 21.065080915178573, 21.63015601748512, 21.9920654296875, 22.37777855282738, 22.852382114955358, 23.282540457589285, 23.712698800223215, 24.12063453311012, 24.641270228794642, 25.228573753720237, 26.088890438988095, 26.779366629464285, 27.526983351934526, 28.206351143973215, 28.839680989583332, 29.519048781622026, 30.220633370535715, 30.80793689546131, 31.465082077752974, 32.05237978980655, 32.82222493489583, 33.523809523809526, 34.225394112723215, 34.858729771205354, 35.43174525669643, 35.906348818824405, 36.42698451450893, 36.92539760044643, 37.30952380952381, 37.85238211495536, 38.30634998139881, 38.984125046502974, 39.52698335193452, 40.07142857142857, 40.71428571428571, 41.32539876302083, 42.58253696986607]
y = [284.8435428884158, 288.0676583336681, 304.11300070794505, 326.53161370049406, 353.2990208015344, 381.04118602134884, 404.58447767713693, 433.45104698043866, 468.76612175399663, 501.9065248935572, 540.3704802603833, 576.5853528804828, 611.900153074289, 647.1399929958628, 682.4550677694208, 715.5954709089814, 752.110184618011, 783.1511509755584, 822.8150198576077, 859.0296178979555, 892.6200572506629, 933.2584096717345, 975.0214407560452, 1017.0843129292859, 1060.9467807956098, 1108.033364107186, 1147.6969584094836, 1175.8891598424445, 1216.0025157781372, 1253.4919876059407, 1288.7318275275145, 1315.4992346285549, 1344.3658039318566, 1376.4567632601625, 1408.1726466475538, 1431.715938303342, 1461.632500577402, 1488.3996330986906, 1512.9926431454853, 1542.9092054195453, 1567.50221546634, 1594.8693047452402, 1623.736148628294, 1666.1739594525727, 1711.3110265266007, 1756.823032251667, 1789.9635726811034, 1840.7989933435592, 1880.3128043912677, 1927.399250412968, 1972.3114366702985, 2008.6011322727547, 2050.3641633570655, 2097.6006672131066, 2131.7909260335496, 2167.1058635172317, 2202.3457034388057, 2224.7643164313545, 2493.1126180222227, 2496.711672118513] 
z_dim_1_interp_07 = create_interp(x, y)

# z dim = 0.4
x = [8.932396417827205, 9.860464852200513, 10.69335013225054, 11.558681424080586, 12.330992364960789, 13.16603648720592, 13.752298803829772, 14.371011093411981, 14.98756057962074, 15.699297181331122, 16.315846667539887, 16.78096426700243, 17.30448944108302, 17.830181379715384, 18.448893669297593, 19.065443155506358, 19.530556793790563, 20.147106279999324, 20.735535361174957, 21.352084847383725, 22.00108430655084, 22.680370935302868, 23.361820367428336, 23.94808268405219, 24.997295835586808, 25.553270982625744, 26.358031896464304, 27.160630006929424, 28.025957337581133, 28.921579760174417, 30.096267196795562, 30.99188961938886, 32.07355274388183, 33.3391016892577, 34.17414977268118, 35.7836716003583, 37.01893337614928, 38.284482321525154, 39.67549762963088, 41.06652086009329, 42.269332662925905, 43.38994209285425, 44.40886807480396, 45.30449049739724, 46.13953858082072, 46.97457874188751, 47.93077550365062, 48.85883997684559, 49.75446239943889, 50.836125523931855, 52.0411080524946, 52.87398541018794, 53.977284490772035, 55.11952195443482, 56.421854401872636]
y = [296.020305488075, 294.58366405546457, 315.1119996282476, 348.77872557100613, 375.15774766879866, 398.66273512667993, 441.15679947954607, 485.0875052650241, 539.3855599130965, 584.7532830185302, 633.2002752542479, 681.5450261321246, 724.0387145976459, 773.8204827954781, 835.4058654011722, 902.8417465882031, 961.4504773087987, 1010.6161661481672, 1058.9607290823708, 1104.4312573766633, 1151.3388029909113, 1196.5014795496443, 1241.9720078439364, 1293.293034719566, 1349.0279187439223, 1375.4069408417151, 1416.3611826857666, 1454.544195078766, 1497.0380714879602, 1539.5319478971544, 1582.0258243063483, 1648.332915796328, 1709.1997897420435, 1750.256648831282, 1799.011680746232, 1835.347206838529, 1879.3807178128654, 1917.4609250170054, 1941.5819918333505, 1985.615502807687, 2028.1093792168813, 2064.6499518558785, 2112.994514790083, 2162.7760950442425, 2211.223275223633, 2271.2690232641844, 2324.027161431606, 2372.371630393974, 2413.4285834550487, 2463.3127809543953, 2513.094267236718, 2555.6908548629353, 2610.8097535006636, 2648.89005467664, 2674.2427163788957]
z_dim_0_4_interp_07 = create_interp(x, y)

# z dim = 0.2
x = [9.074072090485014, 9.801892681294555, 10.615844603228435, 11.37165935521824, 12.099479946027781, 12.767010576470096, 13.52282138562029, 14.162357854882343, 14.51119664590521, 15.006456728419643, 15.239017236714748, 15.55770513329459, 15.84840281153378, 16.19724160255664, 16.692505627910677, 17.44832037990048, 18.08785290632293, 18.843667658312732, 19.687766531850027, 20.413434332236413, 21.07019706772333, 21.767870706929457, 22.465548288975185, 23.04694364545355, 23.802754454603757, 24.704994440924732, 25.40267202297046, 26.130488670940398, 26.828166252986126, 27.87467474037551, 28.804908887876746, 29.99569376201375, 31.11756568557208, 32.16408205864067, 33.09431620614191, 34.31524014620312, 35.27346845488462, 36.38027084548084, 37.51291460683417, 38.85012865814195, 39.81050975724659, 40.47157413074022, 41.14125755160569, 41.72265290808407, 42.601204314071104, 43.445303187608395, 44.433678447893314, 45.18948925704352, 45.7127435007382, 45.770884613521886, 45.82902572630556, 46.11972340454476, 46.294138857216566, 50.44143046483647, 51.662362290576894, 52.70887077796629, 53.697246038251194, 54.804048428847416, 56.02498025458783, 57.101635693580654, 58.14814418097004, 58.64125935874051, 59.62962673334622, 60.35745126699537, 61.43195391556501, 62.652885741305425, 63.8974982617006, 65.75796655670307]
y = [296.9858390726216, 296.9858390726216, 313.5305142343252, 334.16002657115683, 368.6791821061116, 400.3383532171328, 434.8575087520869, 473.4615014621697, 524.5249581579882, 582.4311342235324, 633.3924886900141, 683.0265141751264, 734.0899708709449, 772.6941505814476, 818.2427778901714, 855.4171523891268, 887.178612729904, 927.1103084221972, 976.7441469068889, 1014.0206236351808, 1048.6416943990519, 1091.3308982851022, 1136.879525593826, 1167.2113677234765, 1211.3301898206537, 1256.8790041297977, 1292.7256756465429, 1325.814838969531, 1356.1466810991813, 1387.8060392106222, 1430.5973453260087, 1467.7715328245445, 1493.6097548608823, 1528.0266211660808, 1548.7584227326688, 1569.3881220699207, 1581.8475860556566, 1596.9624560058137, 1610.7496229737603, 1635.5664487158963, 1665.8982908455469, 1716.4512363946844, 1761.9998637034082, 1814.3912103818575, 1861.778238819893, 1887.9227675442392, 1918.25442267347, 1944.5012406275725, 1980.3477251438976, 2035.496393015684, 2083.8027155185855, 2184.3979084697594, 2247.8189139223978, 2245.0614057286407, 2249.146429904188, 2249.146429904188, 2275.393247858291, 2311.239732374616, 2351.1715215671193, 2396.720242376053, 2449.111495554292, 2491.8006059401328, 2548.3790790234657, 2588.412970445305, 2627.0169631553877, 2669.7061670414378, 2717.7059023557003, 2786.233234777879]
z_dim_0_2_interp_07 = create_interp(x, y)

# z dim = 0.1
x = [9.06359917340466, 9.925625153083361, 10.646155771648756, 11.451582012523291, 12.17211263108868, 12.727204604667767, 13.282296578246847, 13.80909266832095, 14.309761202911858, 14.808257423583875, 15.335049527760878, 15.807422178846807, 16.39081402182797, 16.80658693410974, 17.3899787770909, 18.027790073163136, 18.77662056113061, 19.525451049098084, 20.385300728960797, 21.219026839237415, 22.161595841593282, 23.160756610959112, 24.188225221521222, 25.058952414566782, 25.725067565938197, 26.69593643769615, 27.50135869267359, 28.22188931123898, 29.30377338899506, 30.191926924156952, 30.969049309732313, 32.02264148988051, 33.02180225924634, 33.9643712616022, 34.96354000276223, 35.96270077212806, 36.73983112949762, 37.68457643166947, 38.931899154411866, 40.124806409960286, 41.04125184273006, 42.12313592048614, 43.178896428656145, 44.06704996381802, 45.0096109943797, 45.78674135174925, 46.84032556010325, 48.08983255445584, 49.31103170761213, 50.66937760814686, 51.86662949153306, 52.80919849388893, 53.41000870719222, 54.10441575617153, 54.96426145013713, 55.909006752309, 56.90817549346901, 58.04448301021328, 59.10024351838325, 60.15382772673726, 61.26401167389544, 62.12386533965524, 62.78997251923246, 64.03947154179085, 65.3194467335673, 66.42745438090947, 67.62253793627389, 68.42579186322953, 69.20291424880489, 69.86902940017629, 70.53513657975353, 71.20125173112494, 77.57065949258335, 79.31865074991666, 81.28868039104043, 80.18720961494043]
y = [308.12481854745295, 318.66084001062956, 331.7789489511928, 354.19385893654373, 387.14441211266114, 421.3345639795776, 456.86758290549136, 495.08633594940216, 538.5729105886959, 588.5669055141714, 637.3216800212591, 682.0478533513517, 730.8022495860283, 763.6495343939462, 804.5538324196478, 840.9131874273598, 875.2066076624751, 909.3969486655965, 944.9297784553061, 972.6125100360399, 1016.0990846753335, 1046.3640928696593, 1091.0902661997525, 1128.275957289262, 1171.6592635603563, 1212.5635615860583, 1253.3645912435609, 1283.629599437887, 1332.384184808769, 1362.6491930030952, 1391.1580715294212, 1430.7195024961252, 1470.1776650946294, 1508.3964181385402, 1547.854580737045, 1583.387599662959, 1604.4594534531068, 1634.827730015632, 1666.4356052689564, 1691.4326027316943, 1713.744055212641, 1742.769464716168, 1765.1841855653138, 1783.5704943736707, 1798.031659509437, 1805.9852152228166, 1812.5959038771973, 1824.3715240311735, 1824.3715240311735, 1829.6393456265562, 1850.607931048505, 1882.215806301829, 1933.6561257907076, 1973.2175567574109, 2017.943540951298, 2036.4331181278542, 2056.162293995209, 2070.62326999477, 2090.352445862125, 2100.888467325302, 2112.7671667112713, 2118.0351774428595, 2132.4961534424206, 2177.222326772513, 2225.770375406997, 2257.378250660321, 2282.3752481230595, 2299.418689872418, 2317.908267048974, 2342.9052645117113, 2365.3199853608576, 2671.3788691357136, 2762.277256654994, 2732.0121538925646, 2803.0781917443933, 2771.5736794273707]
z_dim_0_1_interp_07 = create_interp(x, y)

# z dim = 0.04
x = [9.069407914550164, 9.83910837007319, 10.628158023303284, 11.39785847882631, 12.029957203432701, 12.571754423053376, 13.498405807200104, 13.94990545859961, 14.650803080282042, 15.282901804888434, 16.14075429195912, 17.542553472088535, 18.557352951018384, 19.348552077686538, 20.18489802008301, 20.79549807354427, 21.449099406060334, 22.330596100949666, 23.416347887158153, 24.295695108609422, 25.357794813470186, 26.353245094692966, 27.391692718206002, 28.11409688456265, 28.814990569480546, 29.808291377265263, 30.401695643222055, 30.98864361533559, 31.53259424515886, 31.915287125953235, 32.41194146661013, 34.97688528701178, 36.264734817572304, 37.191386201719034, 38.0492386887897, 38.659838742250976, 39.337088219350214]
y = [331.91340795834526, 336.20244964943544, 357.64915410826376, 390.9427093350522, 424.2362645618399, 457.529819788628, 517.5805174731793, 565.8864666204714, 609.9033740766737, 649.5287636102413, 694.6687956041436, 741.851620213736, 716.1155000629726, 671.0775702997702, 634.5159956888921, 604.4904598461944, 579.7757360032757, 545.4611584694878, 571.1972786202512, 603.4694375391938, 633.4945993810474, 651.6732844557861, 671.0775702997702, 656.064802378421, 636.6605165344375, 624.9161419980228, 734.2941851377113, 827.2300291262511, 921.289184652913, 1008.7100121802724, 1123.5009695504407, 1169.5602956214884, 1283.2277544531112, 1354.001804367077, 1412.622883821406, 1455.6183949697636, 1480.231016581982]
z_dim_0_04_interp_07 = create_interp(x, y)

# z dim = 0.01
x = [9.208289514464862, 10.176134632755936, 11.128793036309839, 12.26156222102723, 13.381314221684182, 14.238489434465075, 14.776664167777039, 15.412491622538749, 16.035297919740607, 16.74056625015563, 17.51310989904663, 18.079496478155022, 19.490033138985062, 20.622806297201862, 22.005135085734874, 23.691269692000816, 25.1669161141295, 26.41035917785648, 27.530107205014026, 28.88422812125001, 30.320807097199747, 31.62501291387308, 33.172269742331814, 34.65224727881515, 36.060614408968455, 37.573150799600526, 38.62345795110477, 39.63253607275213, 40.96061467386842, 42.2995409283684, 43.328152773105245, 44.03341713002085, 44.65405389654597, 45.387538046256836, 46.29896344645445, 47.43390613534798, 47.857067928296885, 48.13483143091011, 48.7532986667585, 49.293646904246614, 49.84484279511843, 50.05316542207835, 50.97978548401196, 51.97583847460007, 53.05652700257748, 54.18496109944079, 55.02911515466185, 57.02773767486709, 58.48818943525978, 59.605775878739394, 60.42822668019423, 61.75196621995705, 62.78707870972527, 63.906834683881634, 64.93109952026617, 69.06072566695187, 70.63836387188378, 71.66262870826833, 72.51979994754981, 73.85004807934284, 75.07396536697917, 76.22192523993314, 77.06390976447744, 78.05997070206436]
y = [253.97433720619986, 254.69538571001223, 263.8652662898908, 263.8652662898908, 265.20473368315817, 288.0779316682974, 347.83628851642567, 406.8739741755, 469.2082588810461, 409.5525316472756, 349.1757559096923, 309.09625029983016, 283.5444948429161, 272.4171052950736, 267.1622426511214, 271.69567947650273, 271.07763790180695, 270.3562120832361, 283.5444948429161, 291.3749080295273, 296.01135178402524, 306.52069975717114, 301.26583711321894, 315.69058033705045, 345.8787795484625, 376.067356074633, 408.2130642540082, 440.9775686375976, 462.61430615858535, 483.63262479011877, 548.3368234948509, 594.2892333233615, 637.5627083653377, 671.6663028274353, 678.8786744393507, 685.4726271618115, 752.3403486927392, 809.4201480690915, 900.912751352269, 986.8414712041463, 1072.1519608239478, 1117.7951612077304, 1125.6255743943425, 1228.6577835992052, 1372.0783305438993, 1488.2986338510634, 1488.2986338510634, 1720.5328492924, 1884.1478480930782, 1993.980023878634, 2048.0718676811043, 2087.7391569171227, 2113.9093312634927, 2141.521979932245, 2152.0313279053908, 2227.9659230870816, 2262.481733923022, 2284.736513018707, 2300.500534978426, 2333.9858992084473, 2368.089493670545, 2390.344461423608, 2409.4053654158683, 2428.4663637368176]

z_dim_0_01_interp_07 = create_interp(x, y)

def z_dim_1_model_07(m_zams, R_ce, kstar):
    return z_dim_1_interp_07(m_zams) < R_ce

def z_dim_0_4_model_07(m_zams, R_ce, kstar):
    return z_dim_0_4_interp_07(m_zams) < R_ce

def z_dim_0_2_model_07(m_zams, R_ce, kstar):
    return z_dim_0_2_interp_07(m_zams) < R_ce

def z_dim_0_1_model_07(m_zams, R_ce, kstar):
    return z_dim_0_1_interp_07(m_zams) < R_ce

def z_dim_0_04_model_07(m_zams, R_ce, kstar):
    return z_dim_0_04_interp_07(m_zams) < R_ce

def z_dim_0_01_model_07(m_zams, R_ce, kstar):
    return z_dim_0_01_interp_07(m_zams) < R_ce

default_criterion_func = lambda M, R, kstar: False #everything merges!

z_func_dict = {
    1: z_dim_1_model,
    0.4: z_dim_0_4_model,
    0.2: z_dim_0_2_model,
    0.1: z_dim_0_1_model,
    0.04: z_dim_0_04_model,
    0.01: z_dim_0_01_model
}

z_func_dict_07 = {
    1: z_dim_1_model_07,
    0.4: z_dim_0_4_model_07,
    0.2: z_dim_0_2_model_07,
    0.1: z_dim_0_1_model_07,
    0.04: z_dim_0_04_model_07,
    0.01: z_dim_0_01_model_07
}

def get_nearest_model_z_log(z):
    z_dimensionless = z / 0.02
    z_dimensionless_for_each_model = [1, 0.4, 0.2, 0.1, 0.04, 0.01]
    closest_z = min(z_dimensionless_for_each_model, key=lambda x: abs(np.log10(x) - np.log10(z_dimensionless)))
    return closest_z

def get_criterion_func(z, criteria_type='Klencki_1.0'):
    closest_z = get_nearest_model_z_log(z)

    if criteria_type == 'Klencki_1.0':
        return z_func_dict[closest_z]
    
    elif criteria_type == 'Klencki_0.7':
        return z_func_dict_07[closest_z]
    
    elif criteria_type == 'all_mergers':
        return default_criterion_func
    
    elif criteria_type == 'pessimistic_cut':
        #all stars without a well defined core-envelope boundary merge
        return lambda M, R, kstar: (False if kstar in [0, 1, 2, 7, 8, 10, 11, 12] else z_func_dict_07[closest_z](M, R, kstar))

    else:
        raise ValueError(f'Unknown criteria type: {criteria_type}')